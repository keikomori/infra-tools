# Infraestrutura de Desenvolvimento com Docker Swarm e Traefik

Este projeto configura um ambiente de desenvolvimento completo com Docker Swarm, centralizando serviÃ§os essenciais como Traefik, PostgreSQL, Portainer, Grafana e Odoo, com suporte a HTTPS local utilizando `mkcert`.

## Estrutura Geral do Projeto

```bash
infra-tools/
â”œâ”€â”€ certs/                           # Certificados SSL gerados com mkcert
â”œâ”€â”€ traefik/                         # Proxy reverso com HTTPS local
â”œâ”€â”€ postgres/                        # Banco de dados PostgreSQL para dev
â”œâ”€â”€ portainer/                       # Interface de gerenciamento de containers
â”œâ”€â”€ monitoring/                      # Grafana e Prometheus
â”œâ”€â”€ odoo/                            # Plataforma Odoo com suporte a debug remoto
```

## Funcionalidades

### ğŸ” Traefik com HTTPS Local

* Gerenciamento de roteamento com SSL local usando `mkcert`
* Acesso via domÃ­nios personalizados como `traefik.infra.local`, `portainer.infra.local`, etc
* ConfiguraÃ§Ã£o dinÃ¢mica via `traefik_dynamic.toml`

### ğŸ—ƒï¸ PostgreSQL para Desenvolvimento

* Rodando em container isolado
* IntegraÃ§Ã£o direta com Odoo
* Acesso local via `localhost:5432` e pela rede Swarm via `postgres`

### ğŸ“Š Portainer

* Interface web para gerenciamento de stacks, serviÃ§os e containers
* Acesso com HTTPS local em `https://portainer.infra.local`

### ğŸ“ˆ Grafana

* Dashboard de visualizaÃ§Ã£o com HTTPS local em `https://grafana.portainer.infra.local`
* Pronto para se integrar com Prometheus e cAdvisor

### ğŸ§  Odoo com Debug Remoto

* Configurado com `debugpy` para uso com PyCharm
* Breakpoints funcionam no core e em mÃ³dulos personalizados
* Executado via Docker Swarm na rede `keiko_network`

## Rede Compartilhada

Todos os serviÃ§os usam a rede externa `keiko_network`, o que permite comunicaÃ§Ã£o entre containers como:

* Odoo acessando o banco PostgreSQL via `postgres`
* Grafana acessando Prometheus (em futuras integraÃ§Ãµes)
* Portainer gerenciando containers de todas as stacks

## Certificados com mkcert

```bash
mkcert traefik.infra.local
mkcert portainer.infra.local
mkcert grafana.portainer.infra.local
```

Os certificados `.pem` sÃ£o montados diretamente no Traefik para HTTPS local confiÃ¡vel.

## Hosts Locais

Adicione ao `/etc/hosts`:

```bash
127.0.0.1 traefik.infra.local portainer.infra.local grafana.portainer.infra.local
```

## Deploy das Stacks

```bash
cd traefik && docker stack deploy -c docker-compose.yml traefik
cd postgres && docker stack deploy -c docker-compose.yml postgres
cd portainer && docker stack deploy -c docker-compose.yml portainer
cd monitoring && docker stack deploy -c docker-compose.yml monitoring
cd odoo && docker stack deploy -c docker-compose.yml odoo
```

---

Com isso, vocÃª terÃ¡ um ambiente local robusto e realista para desenvolvimento, testes e validaÃ§Ãµes de serviÃ§os que simulam a produÃ§Ã£o.
